## 2. ビジネスディメンションのモデリング（第3章）
顧客・口座・日付等の分析の切り口を **ディメンション** として定義し、キー設計や履歴管理方式を決める工程。

### 作り方（BEAM\* 手順）
1. **ディメンションを発見する**  
   顧客、口座、日付、チャネル、ATM種別/地域 など
2. **ビジネスに必要な属性を定義**  
   CV（変化が少ない/最新値のみの属性）と HV（履歴を保持する属性）を分類
3. **将来の分析ニーズも考慮**  
   例：顧客の住所・ステータス変更を履歴で追跡できるようにする

---

### 階層（Hierarchy）とは？
- ディメンション内で集計・分析の粒度を切り替えるための論理的な親子関係
- 例：
  - **日付**：年 → 四半期 → 月 → 日
  - **地域**：全国 → 都道府県 → 市区町村
  - **顧客**：全顧客 → 個人顧客 → VIP顧客
- BIツールでの *drill-down / roll-up* を可能にするため、設計時に明示しておく

---

### 💡 **ポイント**
- **HV（Historical Value）** は「いつからいつまで有効か」を管理（有効開始/終了・現行フラグなど）  
- **CV（Current Value）** は常に最新の値のみを保持し、集計効率を高める  
- 履歴管理の基本は **SCDタイプ2（Type 2）**：変更のたびに新レコードを追加して履歴を保持

---

### 顧客ディメンション（SCD対応）
- 顧客ID（**主キー**）
- 氏名（CV/HV）
- 生年月日（CV）
- 性別（CV）
- 住所（CV/HV）
- 顧客ステータス（個人/VIP など）（CV/HV）
- 有効開始日（HV）
- 有効終了日（HV）
- 現行フラグ（CV）

> **階層例**：顧客セグメント（全顧客 → 個人顧客 → VIP顧客）

### 口座ディメンション（SCD対応）
- 口座ID（**主キー**）
- 口座種別（普通/貯蓄 など）（CV）
- 開設日（CV）
- 通貨（CV）
- 利用状況（有効/休眠/解約）（CV/HV）
- 有効開始日（HV）
- 有効終了日（HV）
- 現行フラグ（CV）
> **階層例**：口座（全口座 → 普通預金 → 貯蓄預金）

### 日付ディメンション（静的）
- 日付ID（**主キー**）
- 年 / 四半期 / 月 / 日 / 曜日
> **階層例**：日付（年 → 四半期 → 月 → 日）

### チャネルディメンション（静的）
- チャネルID（**主キー**）
- チャネル種別（スマホアプリ/オンラインAPI など）（CV）
- プラットフォーム（iOS/Android）（CV）
> **階層例**：チャネル（全チャネル → スマホアプリ → iOS / Android）

### ATM種別/地域ディメンション（SCD対応）
- ATM種別ID（**主キー**）
- 提携ATM名称（例：セブン銀行）（CV）
- ATM設置地域（都道府県/市区町村）（CV/HV）
- 有効開始日（HV）
- 有効終了日（HV）
- 現行フラグ（CV）
> **階層例**：地域（全国 → 都道府県 → 市区町村）
